<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Pie Trivia</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TriviaGame = () => {
            const categoryMapping = {
                "Geography": 22,
                "Pop Culture": 9,
                "History": 23,
                "Art & Literature": 25,
                "Science": 17,
                "Sports": 21
            };

            const categoryColors = {
                "Geography": { bg: "bg-blue-500", text: "text-blue-900", border: "border-blue-500", light: "bg-blue-100", hex: "#3b82f6" },
                "Pop Culture": { bg: "bg-pink-500", text: "text-pink-900", border: "border-pink-500", light: "bg-pink-100", hex: "#ec4899" },
                "History": { bg: "bg-yellow-500", text: "text-yellow-900", border: "border-yellow-500", light: "bg-yellow-100", hex: "#eab308" },
                "Art & Literature": { bg: "bg-amber-700", text: "text-amber-900", border: "border-amber-700", light: "bg-amber-100", hex: "#b45309" },
                "Science": { bg: "bg-green-500", text: "text-green-900", border: "border-green-500", light: "bg-green-100", hex: "#22c55e" },
                "Sports": { bg: "bg-orange-500", text: "text-orange-900", border: "border-orange-500", light: "bg-orange-100", hex: "#f97316" }
            };

            const categories = ["Geography", "Pop Culture", "History", "Art & Literature", "Science", "Sports"];

            const [gameStarted, setGameStarted] = useState(false);
            const [numPlayers, setNumPlayers] = useState(2);
            const [playerNames, setPlayerNames] = useState([]);
            const [players, setPlayers] = useState([]);
            const [currentPlayerIndex, setCurrentPlayerIndex] = useState(0);
            const [currentCategory, setCurrentCategory] = useState("");
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showResult, setShowResult] = useState(false);
            const [gameOver, setGameOver] = useState(false);
            const [roundNumber, setRoundNumber] = useState(0);
            const [tiebreaker, setTiebreaker] = useState(false);
            const [tiebreakerPlayers, setTiebreakerPlayers] = useState([]);
            const [showPlayerSetup, setShowPlayerSetup] = useState(false);
            const [loading, setLoading] = useState(false);
            const [loadingMessage, setLoadingMessage] = useState("");
            const [questionCache, setQuestionCache] = useState({});
            const [usedQuestions, setUsedQuestions] = useState({});

            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            const decodeHTML = (html) => {
                const txt = document.createElement('textarea');
                txt.innerHTML = html;
                return txt.value;
            };

            const PieChart = ({ completedCategories, showLabels = false }) => {
                return (
                    <div className="relative inline-block">
                        <svg width="100" height="100" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="48" fill="white" stroke="#d1d5db" strokeWidth="2"/>
                            {categories.map((cat, index) => {
                                const isCompleted = completedCategories.includes(cat);
                                const startAngle = (index * 60 - 90) * (Math.PI / 180);
                                const endAngle = ((index + 1) * 60 - 90) * (Math.PI / 180);
                                
                                const x1 = 50 + 45 * Math.cos(startAngle);
                                const y1 = 50 + 45 * Math.sin(startAngle);
                                const x2 = 50 + 45 * Math.cos(endAngle);
                                const y2 = 50 + 45 * Math.sin(endAngle);
                                
                                return (
                                    <g key={cat}>
                                        <path
                                            d={`M 50 50 L ${x1} ${y1} A 45 45 0 0 1 ${x2} ${y2} Z`}
                                            fill={isCompleted ? categoryColors[cat].hex : "#e5e7eb"}
                                            stroke="#9ca3af"
                                            strokeWidth="1.5"
                                        />
                                    </g>
                                );
                            })}
                            <circle cx="50" cy="50" r="20" fill="white" stroke="#9ca3af" strokeWidth="2"/>
                        </svg>
                        {showLabels && (
                            <div className="mt-2 text-xs">
                                {categories.map(cat => (
                                    <div key={cat} className="flex items-center gap-1">
                                        <div className={`w-3 h-3 rounded ${categoryColors[cat].bg}`}></div>
                                        <span className={completedCategories.includes(cat) ? 'font-bold text-green-600' : 'text-gray-500'}>
                                            {cat}
                                        </span>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                );
            };

            const fetchQuestions = async (category, amount = 30) => {
                try {
                    const categoryId = categoryMapping[category];
                    const response = await fetch(`https://opentdb.com/api.php?amount=${amount}&category=${categoryId}&type=multiple`);
                    const data = await response.json();
                    
                    if (data.response_code === 0) {
                        const formattedQuestions = data.results.map(q => {
                            const incorrectAnswers = q.incorrect_answers.map(a => decodeHTML(a));
                            const correctAnswer = decodeHTML(q.correct_answer);
                            const allAnswers = [...incorrectAnswers, correctAnswer].sort(() => Math.random() - 0.5);
                            
                            return {
                                question: decodeHTML(q.question),
                                answers: allAnswers,
                                correct: allAnswers.indexOf(correctAnswer),
                                id: decodeHTML(q.question) // Use question as unique ID
                            };
                        });
                        return formattedQuestions;
                    } else {
                        console.error('API error:', data.response_code);
                        return [];
                    }
                } catch (error) {
                    console.error('Error fetching questions:', error);
                    return [];
                }
            };

            const fetchTiebreakerQuestion = async () => {
                try {
                    const response = await fetch('https://opentdb.com/api.php?amount=1&difficulty=hard&type=multiple');
                    const data = await response.json();
                    
                    if (data.response_code === 0 && data.results.length > 0) {
                        const q = data.results[0];
                        const incorrectAnswers = q.incorrect_answers.map(a => decodeHTML(a));
                        const correctAnswer = decodeHTML(q.correct_answer);
                        const allAnswers = [...incorrectAnswers, correctAnswer].sort(() => Math.random() - 0.5);
                        
                        return {
                            question: decodeHTML(q.question),
                            answers: allAnswers,
                            correct: allAnswers.indexOf(correctAnswer),
                            category: "Tiebreaker"
                        };
                    }
                } catch (error) {
                    console.error('Error fetching tiebreaker:', error);
                }
                return null;
            };

            const startGame = () => {
                setPlayerNames(Array(numPlayers).fill(''));
                setShowPlayerSetup(true);
            };

            const getRandomCategory = () => {
                const randomIndex = Math.floor(Math.random() * categories.length);
                return categories[randomIndex];
            };

            const getRandomQuestion = (category) => {
                const questions = questionCache[category];
                if (!questions || questions.length === 0) return null;
                
                // Filter out used questions
                const used = usedQuestions[category] || [];
                const availableQuestions = questions.filter(q => !used.includes(q.id));
                
                // If we've used all questions, reset for this category
                if (availableQuestions.length === 0) {
                    const newUsed = { ...usedQuestions };
                    newUsed[category] = [];
                    setUsedQuestions(newUsed);
                    return questions[Math.floor(Math.random() * questions.length)];
                }
                
                const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                const selectedQuestion = availableQuestions[randomIndex];
                
                // Mark this question as used
                const newUsed = { ...usedQuestions };
                if (!newUsed[category]) newUsed[category] = [];
                newUsed[category].push(selectedQuestion.id);
                setUsedQuestions(newUsed);
                
                return selectedQuestion;
            };

            const handlePlayerNamesSubmit = async (names) => {
                setLoading(true);
                
                const initialPlayers = names.map(name => ({
                    name: name,
                    completedCategories: [],
                    finishedRound: null,
                }));
                
                setPlayers(initialPlayers);
                
                // Initialize used questions tracker
                const initialUsed = {};
                categories.forEach(cat => {
                    initialUsed[cat] = [];
                });
                setUsedQuestions(initialUsed);
                
                const cache = {};
                for (let i = 0; i < categories.length; i++) {
                    const cat = categories[i];
                    setLoadingMessage(`Loading ${cat} questions... (${i + 1}/${categories.length})`);
                    const questions = await fetchQuestions(cat, 30);
                    cache[cat] = questions;
                    
                    if (i < categories.length - 1) {
                        await sleep(5000);
                    }
                }
                
                setQuestionCache(cache);
                setCurrentPlayerIndex(0);
                
                const randomCat = getRandomCategory();
                setCurrentCategory(randomCat);
                
                if (cache[randomCat] && cache[randomCat].length > 0) {
                    const randomQ = cache[randomCat][Math.floor(Math.random() * cache[randomCat].length)];
                    setCurrentQuestion(randomQ);
                    
                    // Mark first question as used
                    const newUsed = { ...initialUsed };
                    newUsed[randomCat] = [randomQ.id];
                    setUsedQuestions(newUsed);
                }
                
                setGameStarted(true);
                setShowPlayerSetup(false);
                setLoading(false);
                setLoadingMessage("");
            };

            const handleAnswerClick = (answerIndex) => {
                if (showResult) return;
                setSelectedAnswer(answerIndex);
                setShowResult(true);
            };

            const handleNextQuestion = async () => {
                const currentPlayer = players[currentPlayerIndex];
                const isCorrect = selectedAnswer === currentQuestion.correct;
                
                if (isCorrect) {
                    const updatedPlayers = [...players];
                    if (!updatedPlayers[currentPlayerIndex].completedCategories.includes(currentCategory)) {
                        updatedPlayers[currentPlayerIndex].completedCategories.push(currentCategory);
                    }
                    
                    if (updatedPlayers[currentPlayerIndex].completedCategories.length === 6) {
                        updatedPlayers[currentPlayerIndex].finishedRound = roundNumber;
                        setPlayers(updatedPlayers);
                        await checkForWinner(updatedPlayers);
                        return;
                    }
                    
                    setPlayers(updatedPlayers);
                    
                    const randomCat = getRandomCategory();
                    setCurrentCategory(randomCat);
                    const nextQuestion = getRandomQuestion(randomCat);
                    setCurrentQuestion(nextQuestion);
                    setSelectedAnswer(null);
                    setShowResult(false);
                } else {
                    await moveToNextPlayer();
                }
            };

            const moveToNextPlayer = async () => {
                const nextPlayerIndex = (currentPlayerIndex + 1) % players.length;
                
                if (nextPlayerIndex === 0) {
                    setRoundNumber(roundNumber + 1);
                }
                
                let actualNextIndex = nextPlayerIndex;
                let checkedPlayers = 0;
                while (players[actualNextIndex].completedCategories.length === 6 && checkedPlayers < players.length) {
                    actualNextIndex = (actualNextIndex + 1) % players.length;
                    checkedPlayers++;
                }
                
                if (checkedPlayers === players.length) {
                    setGameOver(true);
                    return;
                }
                
                setCurrentPlayerIndex(actualNextIndex);
                
                const randomCat = getRandomCategory();
                setCurrentCategory(randomCat);
                const nextQuestion = getRandomQuestion(randomCat);
                setCurrentQuestion(nextQuestion);
                setSelectedAnswer(null);
                setShowResult(false);
            };

            const checkForWinner = async (updatedPlayers) => {
                const finishersThisRound = updatedPlayers.filter(p => p.finishedRound === roundNumber);
                
                if (finishersThisRound.length > 1) {
                    setLoading(true);
                    setLoadingMessage("Loading tiebreaker question...");
                    const tiebreakerQ = await fetchTiebreakerQuestion();
                    setTiebreaker(true);
                    setTiebreakerPlayers(finishersThisRound);
                    setCurrentPlayerIndex(0);
                    setCurrentQuestion(tiebreakerQ);
                    setCurrentCategory("Tiebreaker");
                    setSelectedAnswer(null);
                    setShowResult(false);
                    setLoading(false);
                    setLoadingMessage("");
                } else {
                    const allFinishers = updatedPlayers.filter(p => p.finishedRound !== null);
                    if (allFinishers.length > 0) {
                        setGameOver(true);
                    } else {
                        await moveToNextPlayer();
                    }
                }
            };

            const handleTiebreakerNext = () => {
                if (selectedAnswer === currentQuestion.correct) {
                    setGameOver(true);
                } else {
                    const nextIndex = currentPlayerIndex + 1;
                    if (nextIndex < tiebreakerPlayers.length) {
                        setCurrentPlayerIndex(nextIndex);
                        setSelectedAnswer(null);
                        setShowResult(false);
                    } else {
                        setGameOver(true);
                    }
                }
            };

            const resetGame = () => {
                setGameStarted(false);
                setPlayers([]);
                setPlayerNames([]);
                setCurrentPlayerIndex(0);
                setCurrentCategory("");
                setCurrentQuestion(null);
                setSelectedAnswer(null);
                setShowResult(false);
                setGameOver(false);
                setQuestionCache({});
                setUsedQuestions({});
                setRoundNumber(0);
                setTiebreaker(false);
                setTiebreakerPlayers([]);
                setShowPlayerSetup(false);
            };

            const handlePlayerNameChange = (index, value) => {
                const newNames = [...playerNames];
                newNames[index] = value;
                setPlayerNames(newNames);
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full text-center border-2 border-indigo-300">
                            <div className="text-6xl mb-4 animate-bounce">ü•ß</div>
                            <h2 className="text-2xl font-bold text-gray-800 mb-2">Loading Questions...</h2>
                            <p className="text-gray-600">{loadingMessage || "Fetching fresh trivia from the internet!"}</p>
                            <p className="text-sm text-gray-500 mt-4">This may take up to 30 seconds due to API rate limits</p>
                        </div>
                    </div>
                );
            }

            if (!gameStarted && !showPlayerSetup) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full border-2 border-indigo-300">
                            <div className="text-center mb-8">
                                <div className="text-6xl mb-4">ü•ß</div>
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">Your Pie</h1>
                                <p className="text-gray-600">How many players?</p>
                            </div>
                            
                            <div className="grid grid-cols-2 gap-4 mb-8">
                                {[2, 3, 4].map(num => (
                                    <button
                                        key={num}
                                        onClick={() => setNumPlayers(num)}
                                        className={`p-6 rounded-lg font-bold text-2xl transition-all border-4 ${
                                            numPlayers === num
                                                ? 'bg-indigo-600 text-white border-indigo-500'
                                                : 'bg-gray-100 text-gray-700 border-gray-300 hover:border-indigo-400'
                                        }`}
                                    >
                                        {num} Players
                                    </button>
                                ))}
                            </div>

                            <div className="bg-indigo-50 border-2 border-indigo-200 rounded-lg p-4 mb-6">
                                <h3 className="font-bold text-indigo-900 mb-2">How to Play:</h3>
                                <ul className="text-sm text-indigo-800 space-y-1">
                                    <li>‚Ä¢ Get ONE correct answer in each of 6 categories to complete your pie!</li>
                                    <li>‚Ä¢ Categories are RANDOM - adds an element of luck!</li>
                                    <li>‚Ä¢ Correct answer = keep going, wrong answer = next player's turn</li>
                                    <li>‚Ä¢ Questions fetched live from the internet - always fresh!</li>
                                    <li>‚Ä¢ If multiple players finish on the same round, there's a tiebreaker!</li>
                                </ul>
                            </div>
                            
                            <button
                                onClick={startGame}
                                className="w-full bg-indigo-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-indigo-700 transition-colors"
                            >
                                Continue
                            </button>
                        </div>
                    </div>
                );
            }

            if (showPlayerSetup) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full border-2 border-indigo-300">
                            <div className="text-center mb-8">
                                <h2 className="text-3xl font-bold text-gray-800 mb-2">Enter Player Names</h2>
                                <p className="text-gray-600">All players required</p>
                            </div>
                            
                            <div className="space-y-4 mb-8">
                                {playerNames.map((name, index) => (
                                    <div key={index}>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">
                                            Player {index + 1} <span className="text-red-500">*</span>
                                        </label>
                                        <input
                                            type="text"
                                            value={name}
                                            onChange={(e) => handlePlayerNameChange(index, e.target.value)}
                                            placeholder={`Enter name for Player ${index + 1}`}
                                            className="w-full p-3 border-2 border-gray-300 bg-white text-gray-800 rounded-lg focus:border-indigo-500 focus:outline-none"
                                        />
                                    </div>
                                ))}
                            </div>
                            
                            <button
                                onClick={() => {
                                    if (playerNames.every(name => name.trim() !== '')) {
                                        handlePlayerNamesSubmit(playerNames);
                                    } else {
                                        alert('Please enter all player names!');
                                    }
                                }}
                                className="w-full bg-indigo-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-indigo-700 transition-colors"
                            >
                                Start Game (takes ~30 seconds to load)
                            </button>
                        </div>
                    </div>
                );
            }

            if (gameOver) {
                let winner;
                if (tiebreaker && selectedAnswer === currentQuestion.correct) {
                    winner = tiebreakerPlayers[currentPlayerIndex];
                } else {
                    const finishers = players.filter(p => p.finishedRound !== null).sort((a, b) => a.finishedRound - b.finishedRound);
                    winner = finishers[0];
                }

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full border-2 border-indigo-300">
                            <div className="text-center mb-8">
                                <div className="text-6xl mb-4">üèÜ</div>
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">Winner!</h1>
                                <p className="text-3xl text-indigo-600 font-semibold">
                                    {winner.name} wins! üéâ
                                </p>
                                {tiebreaker && <p className="text-sm text-gray-600 mt-2">Won by tiebreaker</p>}
                            </div>

                            <div className="mb-8">
                                <h2 className="text-2xl font-bold text-gray-800 mb-4 text-center">Final Results</h2>
                                <div className="space-y-3">
                                    {players.map((player, index) => (
                                        <div
                                            key={index}
                                            className={`p-4 rounded-lg ${
                                                player.name === winner.name
                                                    ? 'bg-gradient-to-r from-yellow-400 to-yellow-500 border-2 border-yellow-600'
                                                    : 'bg-gray-100'
                                            }`}
                                        >
                                            <div className="flex justify-between items-center mb-3">
                                                <span className="font-semibold text-lg text-gray-800">{player.name}</span>
                                                <span className="text-sm text-gray-600">
                                                    {player.completedCategories.length}/6 categories
                                                </span>
                                            </div>
                                            <div className="flex items-center justify-center">
                                                <PieChart completedCategories={player.completedCategories} />
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <button
                                onClick={resetGame}
                                className="w-full bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                            >
                                üîÑ Play Again
                            </button>
                        </div>
                    </div>
                );
            }

            if (tiebreaker) {
                const currentTiebreakerPlayer = tiebreakerPlayers[currentPlayerIndex];
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-3xl w-full border-2 border-yellow-500">
                            <div className="text-center mb-6 bg-yellow-400 border-2 border-yellow-500 rounded-lg p-4">
                                <h1 className="text-3xl font-bold text-gray-900 mb-2">üèÜ TIEBREAKER! üèÜ</h1>
                                <p className="text-gray-800">First correct answer wins!</p>
                            </div>

                            <div className="mb-6 p-6 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg border-2 border-purple-400">
                                <p className="text-center text-white font-bold text-2xl">
                                    {currentTiebreakerPlayer.name}, it's your turn!
                                </p>
                            </div>

                            <h2 className="text-2xl font-bold text-gray-800 mb-8">
                                {currentQuestion?.question}
                            </h2>

                            <div className="space-y-3 mb-8">
                                {currentQuestion?.answers.map((answer, index) => {
                                    let buttonClass = "w-full p-4 text-left rounded-lg font-semibold transition-all border-2 ";
                                    
                                    if (showResult) {
                                        if (index === currentQuestion.correct) {
                                            buttonClass += "bg-green-500 border-green-600 text-white";
                                        } else if (index === selectedAnswer) {
                                            buttonClass += "bg-red-500 border-red-600 text-white";
                                        } else {
                                            buttonClass += "bg-gray-200 border-gray-300 text-gray-500";
                                        }
                                    } else {
                                        buttonClass += "bg-white border-gray-300 text-gray-800 hover:bg-yellow-50 hover:border-yellow-400 cursor-pointer";
                                    }

                                    return (
                                        <button
                                            key={index}
                                            onClick={() => handleAnswerClick(index)}
                                            disabled={showResult}
                                            className={buttonClass}
                                        >
                                            {answer}
                                        </button>
                                    );
                                })}
                            </div>

                            {showResult && (
                                <div className="text-center">
                                    <button
                                        onClick={handleTiebreakerNext}
                                        className="bg-yellow-500 text-gray-900 px-8 py-3 rounded-lg font-semibold hover:bg-yellow-400 transition-colors"
                                    >
                                        {selectedAnswer === currentQuestion.correct ? "See Winner" : "Next Player"}
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            const currentPlayer = players[currentPlayerIndex];
            const catColors = categoryColors[currentCategory];
            const neededCategories = categories.filter(cat => !currentPlayer.completedCategories.includes(cat));

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-4xl w-full border-2 border-indigo-300">
                        <div className="mb-6 grid grid-cols-2 md:grid-cols-4 gap-3">
                            {players.map((player, index) => (
                                <div
                                    key={index}
                                    className={`p-3 rounded-lg ${
                                        index === currentPlayerIndex
                                            ? 'bg-gradient-to-br from-indigo-500 to-purple-600 text-white ring-4 ring-indigo-300'
                                            : player.completedCategories.length === 6
                                            ? 'bg-green-500 text-white'
                                            : 'bg-gray-100 text-gray-800'
                                    }`}
                                >
                                    <div className="font-bold text-sm truncate mb-2">{player.name}</div>
                                    <div className="flex items-center justify-center">
                                        <PieChart completedCategories={player.completedCategories} />
                                    </div>
                                    <div className="text-center text-xs mt-2 font-semibold">
                                        {player.completedCategories.length === 6 ? '‚úì Complete!' : index === currentPlayerIndex ? '‚ñ∂ Playing' : '‚è≥ Waiting'}
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="mb-6 p-6 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg border-2 border-purple-400 shadow-lg">
                            <p className="text-center text-white font-bold text-3xl">
                                {currentPlayer.name}, it's your turn!
                            </p>
                        </div>

                        <div className="mb-6 bg-gray-50 rounded-lg p-4 border-2 border-gray-200">
                            <p className="text-sm font-semibold text-gray-700 mb-2">Categories Still Needed:</p>
                            <div className="flex flex-wrap gap-2">
                                {neededCategories.map(cat => (
                                    <span
                                        key={cat}
                                        className={`${categoryColors[cat].bg} text-white px-3 py-1 rounded-full text-sm font-semibold`}
                                    >
                                        {cat}
                                    </span>
                                ))}
                                {neededCategories.length === 0 && (
                                    <span className="text-green-600 font-bold">All categories complete! üéâ</span>
                                )}
                            </div>
                        </div>

                        <div className="mb-8 text-center">
                            <span className={`inline-block ${catColors.bg} text-white px-8 py-4 rounded-xl font-bold text-4xl shadow-lg`}>
                                {currentCategory}
                            </span>
                        </div>

                        <h2 className="text-2xl font-bold text-gray-800 mb-8 text-center">
                            {currentQuestion?.question}
                        </h2>

                        <div className="space-y-3 mb-8">
                            {currentQuestion?.answers.map((answer, index) => {
                                let buttonClass = "w-full p-4 text-left rounded-lg font-semibold transition-all border-2 ";
                                
                                if (showResult) {
                                    if (index === currentQuestion.correct) {
                                        buttonClass += "bg-green-500 border-green-600 text-white";
                                    } else if (index === selectedAnswer) {
                                        buttonClass += "bg-red-500 border-red-600 text-white";
                                    } else {
                                        buttonClass += "bg-gray-200 border-gray-300 text-gray-500";
                                    }
                                } else {
                                    buttonClass += `bg-white border-gray-300 text-gray-800 hover:bg-${catColors.light} hover:${catColors.border} cursor-pointer`;
                                }

                                return (
                                    <button
                                        key={index}
                                        onClick={() => handleAnswerClick(index)}
                                        disabled={showResult}
                                        className={buttonClass}
                                    >
                                        {answer}
                                    </button>
                                );
                            })}
                        </div>

                        {showResult && (
                            <div className="text-center">
                                <div className="mb-4">
                                    {selectedAnswer === currentQuestion.correct ? (
                                        <p className="text-green-600 font-bold text-xl">
                                            Correct! {currentPlayer.completedCategories.includes(currentCategory) ? "Keep going!" : `${currentCategory} slice added to your pie! ü•ß`}
                                        </p>
                                    ) : (
                                        <p className="text-red-600 font-bold text-xl">Wrong! Next player's turn.</p>
                                    )}
                                </div>
                                <button
                                    onClick={handleNextQuestion}
                                    className="bg-indigo-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors text-lg"
                                >
                                    Continue
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TriviaGame />);
    </script>
</body>
</html>